# TIL(Today I Learned)

___

> Mar/1st/2022_Multi campus_유선종 Day49

## 딥러닝 - 퍼셉트론
어제부터 딥러닝에 대해 알아보고 있다. 딥러닝을 이해하기 위해서는 퍼셉트론이라는 구조를 이해해야 한다. 매우 간단한 예시를 통해서 퍼셉트론의 구조를 파악하고 딥러닝에서는 중간에 함수만 추가해주는 것이기 때문에 퍼셉트론의 구조를 잘 파악해야 딥러닝 또한 잘 이해할 수 있다.
> 여기서 서술하는 내용은 밑바닥부터 시작하는 딥러닝(Deep Learning from Scratch)을 기반으로 내가 추가 설명을 덧붙이는 내용이다. 이 책은 내가 가르침의 원칙으로 삼고 있는 '초등학생도 이해하게 가르친다'를 철저히 지킨 책이므로 꼭 한번 읽어보자. ~~사이토상 사이코!~~

### 1. 퍼셉트론의 구조
- 퍼셉트론은 다수의 신호를 입력(input)으로 받아 하나의 신호를 출력(output)한다.
- 여기서 신호는 전류라고 생각하면 좋다. 실제로 우리의 뇌는 전기를 이용해서 신호를 주고받는다. 매우 소량의 전기를 뉴런을 통해 전달하여 어떠한 행동을 하게 만든다.
- 인간의 뇌 구조와 다르게 퍼셉트론의 신호는 흐른다/안 흐른다의 두가지의 신호만 출력한다. 여기서 흐른다는 1, 안 흐른다는 0으로 표현한다.

<img src="https://user-images.githubusercontent.com/97590480/156158508-6a9e996b-4ba0-4e7e-82cb-63a7371a9951.png">

1. 위의 이미지를 보면 x1, x2라는 두 개의 신호를 받아 y라는 신호를 출력하는 것을 볼 수 있다.
2. x1과 y 사이에 이어진 직선에 w1이라는 표시가 있는데, 이를 우리는 가중치(weight)라고 부른다.
   - 다른 분야에서 사용하는 가중치의 의미는 비중(무게중심)을 의미한다. 예를 들어, 100원짜리 사탕을 5개, 300원짜리 껌을 5개 팔았다고 하자. 그러면 전체 매출에서 사탕이 차지하는 비중은 (100 * 5) / (100 * 5 + 300 * 5) = 0.25, 즉 25%이다. 여기서 0.25를 사탕의 가중치라 한다.
   - 그러나 퍼셉트론에서 사용하는 가중치는 비중의 의미가 아니다. 비중은 스스로 결정하는 것이 아닌 결과값에 의해 결정이 된다. 위의 예를 보면 사탕 5개와 껌 5개라는 결과가 주어져있기 때문에 사탕이 매출의 어떤 비중을 차지하는지를 구할 수 있었다.
   - 하지만 퍼셉트론에서는 가중치를 사람이 정한다.
   - 반면에, 딥러닝으로 넘어가면 이러한 가중치도 사람이 정하지 않고 데이터와 활성화 함수 및 역전파 알고리즘을 통해 결정한다. 이 경우에는 비중과 비슷한 의미를 지닐 수 있지만 정확하게 비중을 의미하는 것은 아니라는 것을 명심하자.
3. 가중치를 거친 신호는 w1*x1 + w2*x2 라는 신호로 바뀌고 퍼셉트론은 이 신호를 y에서 1과 0으로 바꾼다. 이때, 1과 0으로 바꾸는 기준이 되는 값을 임계값(threshold)이라고 한다. 밑의 식에서 ​​θ가 임계값을 의미한다.

<img src="https://user-images.githubusercontent.com/97590480/156161023-a680c20a-1329-405f-98a1-f7dbd2b72db1.png">

4. 임계값 θ를 넘었을 경우에는 1, 반대로 임계값보다 작거나 같다면 0으로 출력한다.

___

### 2. 단순한 논리 회로
퍼셉트론에 대한 구조는 다 설명했다. 이제 실제로 어떻게 쓰이는 지를 논리 회로를 만들어보면서 살펴보자.

#### 1. AND 게이트
우리는 파이썬에서 두개의 불형 자료를 and나 or를 이용해서 결과값을 출력하면 and와 or이 서로 다른 결과값을 가지는 것을 볼 수 있다. 예를 들어, True, False를 and로 출력할 경우 False가 나오고, or로 출력하면 True로 나온다. 이러한 파이썬의 논리 구조를 퍼셉트론을 통해서 구현해보자.

<img src="https://user-images.githubusercontent.com/97590480/156162177-d1574a68-a56e-401d-8c08-6a322e67ea89.png">

1. 위의 표를 진리표라고 하는데, 위의 진리표는 and 논리 구조를 표현한 진리표이다.
2. 위의 진리표처럼 만들기 위해서 우리는 가중치와 임계값을 우리가 설정해줘야 한다. 예를 들어, (x1, x2, θ) = (0.5, 0.5 ,0.6) 으로 설정해준다면 위의 결과를 도출할 수 있다. 이를 python을 통해 구현해보자.

```python
def AND(x1, x2):
    w1, w2, theta = 0.5, 0.5, 0.6
    function = x1 * w1 + x2 * w2
    if function <= theta:
        return 0
    elif function > theta:
        return 1
```
3. 위의 AND 함수를 이용해서 입력해보면 진리표와 동일한 결과가 나온다. w1, w2, theta는 우리가 임의로 설정하므로 값을 바꿔줘도 괜찮다.

___

#### 2. NAND 게이트
NAND 게이트는 Not AND 게이트를 의미하고, 진리표를 보면 다음과 같다.

<img src="https://user-images.githubusercontent.com/97590480/156169306-3c91a796-5041-42d0-81b2-d1fdf6235b60.png">

1. AND 게이트와 정반대의 출력값을 가지는 것을 알 수 있다. 이를 구현하기 위해서는 AND의 반대 즉, 마이너스 부호를 붙여주면 된다.
2. 즉, (w1, w2, θ) = (-0.5, -0.5, -0.6)을 입력하면 위의 진리표처럼 출력된다.
3. 이를 파이썬으로 도출해보자. 이번에는 theta를 왼쪽으로 이항시켜 임계값을 0으로 갖는 형태로 표현해보겠다.
4. 식으로 표현하면 x1 * w1 + x2 * w2 + b = θ, (단, θ = -b) 이다.

```python
def NAND(x1, x2):
    w1, w2, b = -0.5, -0.5, -0.6
    function = x1 * w1 + x2 * w2 + b
    if function <= 0:
        return 0
    elfi function > 0:
        return 1 
```
5. 위의 식처럼 theta를 이항시킬 경우 임계값을 0으로 통일시킬 수 있어서 알아보기가 휠씬 쉽다. 이때, b를 우리는 편향(Bias)라고 부른다.
6. 편향은 치우친 정도를 의미하는데, 임계값(여기서는 0)에서부터 얼마나 치우쳐있는지를 알 수 있다.

___

#### 3. OR 게이트
OR 게이트는 OR의 논리 구조를 퍼셉트론으로 구현한 것이다. 진리표는 다음과 같다.

<img src="https://user-images.githubusercontent.com/97590480/156170118-ee2fc37c-997d-4dc1-a2f2-01b9317feacb.png">

1. 이 진리표를 구현하기 위해서 가중치와 편향을 (w1, w2, b) = (0.5, 0.5, 0.4)로 입력하면 구현할 수 있다.
2. 이것도 파이썬을 통해, 그리고 넘파이를 이용해 벡터 형태로 구현해보면 다음과 같다.

```python
import numpy as np
def OR(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.4
    function = np.sum(x*w) + b
    if function <= 0: return 0
    elif function > 0: return 1
```
3. 벡터 또는 행렬 형태로 표현하면 수많은 데이터들을 다룰때 훨씬 쉽기 때문에 앞으로는 행렬 형태로 표현해야 한다. ~~선형대수학은 필수이다.~~

___

### 3. 다층 퍼셉트론

#### 1. XOR 게이트
우리는 지금까지 입력값을 입력하면 게이트를 거쳐 출력값을 출력해주는 퍼셉트론을 알아보았다. 그러나 이러한 퍼셉트론은 너무나 단순해서 구현할 수 있는 구조가 한정적이다. 예를 들어 XOR 게이트를 구현해보면 바로 알 수 있다.

<img src="https://user-images.githubusercontent.com/97590480/156171193-c39a6fd5-9b1c-485b-b7b9-9e4dc733e6b9.png">

1. XOR 게이트는 배타적 논리합이라고 부르는데, 자신을 제외한 나머지는 모두 False가 되는 논리구조이다.
2. 이를 구현해보면 단층 퍼셉트론으로는 구현할 수 없다는 것을 알 수 있다.
3. 하지만 우리가 구현했던 AND, NAND, OR 게이트를 이용하면 구현이 가능하다.

<img src="https://user-images.githubusercontent.com/97590480/156171469-c3dcb0ca-dc4b-4128-b69b-c3532646a6ac.png">

- 위의 진리표는 3개의 게이트가 합쳐진 진리표이다.
- s1에는 NAND 게이트, s2에는 OR 게이트의 출력값을 나열한다.
- 그리고 s1과 s2를 입력값으로 받는 AND 게이트를 출력하면 y라는 출력값이 나오고, 이는 XOR 게이트의 진리표와 동일하다.
- 이런 식으로 다층 퍼셉트론 구조를 통해서 다양한 논리구조를 표현할 수 있다.

___

#### 2. 선형과 비선형
우리는 단층 퍼셉트론과 다층 퍼셉트론을 그래프로 시각적으로 표현하면 선형과 비선형으로 표현할 수 있다. 다음 그림을 살펴보자.

<img width = "50%" src="https://user-images.githubusercontent.com/97590480/156172908-9e63da16-f4fa-438e-82b5-d4744ea989e1.png">

1. 왼쪽 그림은 OR 게이트를, 오른쪽 그림은 XOR 게이트를 그래프로 표현한 것이다.
2. 왼쪽 그림에서 1과 0을 나누는 선을 그려보면 직선의 형태로 표현이 가능하다. 직선의 아래쪽은 0, 직선의 위쪽은 1이다.
3. 반면에, XOR 게이트는 직선의 형태로 표현이 불가능하다. 그림처럼 직선이 아닌 곡선의 형태로 0과 1을 나눠야 한다.
4. 즉, 선형 관계로 나누고 싶다면 단층 퍼셉트론, 비선형의 형태로 나누고 싶다면 다층 퍼셉트론을 사용해야 한다.
5. 앞으로 딥러닝에서 다룰 문제들은 비선형의 관계가 대부분을 차지하므로 기본적으로 다층 퍼셉트론 구조를 다룬다고 생각해야 한다.

___

### 4. 신경망 구조
- 여기까지 퍼셉트론에 대해서 배웠다. 이제 우리는 한발 더 나아가 딥러닝에서 사용하는 신경망 구조를 배워야 한다.
- 신경망 구조는 퍼셉트론과 동일하다. 단, 차이가 있다면 퍼셉트론에서는 가중치를 사람이 정했다면 신경망 구조에서는 컴퓨터가 정한다.
- 이 가중치는 실제 데이터, 활성화 함수, 역전파 알고리즘, 최적화 프로그램을 이용하여 구한다.
- 즉, 신경망 구조의 핵심은 가중치를 어떻게 구하느냐에 달린 것이다.
___
내일은 신경망 구조 중에서 입력 신호의 총합을 출력 신호로 변환해주는 함수인 활성화 함수에 대해 알아보겠다.